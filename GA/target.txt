#include "ros/ros.h"
#include "motorcontroller/robot_msg.h"

double velx;
double baseline;
double diameter;
double theta_dot = 0; //angle is constant so rate of change of angle is zero;

int main(int argc, char **argv)
{
    ros::init(argc, argv, "controller");
    ros::NodeHandle nh;
    ros::Publisher pub;
    pub = nh.advertise<motorcontroller::robot_msg>("wheel_velocity", 1000);

    ros::Rate loop_rate(10);

    nh.getParam("/velocity", velx);
    nh.getParam("/baseline", baseline);
    nh.getParam("/wheel_diameter", diameter);

    while(ros::ok())
    {
        motorcontroller::robot_msg msg;
        msg.left_wheel_velocity = (velx-(baseline/2)*theta_dot)/(diameter/2);
        msg.right_wheel_velocity = (velx+(baseline/2)*theta_dot)/(diameter/2);

        ROS_INFO_STREAM("" << msg);
        pub.publish(msg);
        ros::spinOnce();
        loop_rate.sleep();

    }
}